{"version":3,"sources":["StarCtrl.ts"],"names":[],"mappings":";;;;;AAUM,IAAA,kBAAmC,EAAlC,oBAAO,EAAE,sBAAQ,CAAkB;AAI1C;IAAsC,4BAAY;IADlD;QAAA,qEAuDC;QApDI,2BAA2B;QAEnB,gBAAU,GAAW,CAAC,CAAC;QAEvB,UAAI,GAAS,IAAI,CAAC;;QA+C3B,iBAAiB;IACrB,CAAC;IA9CW,uBAAI,GAAX,UAAY,IAAS;QACjB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;IACrB,CAAC;IAED,oCAAiB,GAAjB;QACI,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QACnC,qBAAqB;QACrB,IAAI,SAAS,GAAG,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,WAAW,EAAE,CAAC;QACnD,iBAAiB;QACjB,IAAI,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,GAAG,EAAE,CAAC;QACnD,OAAO,IAAI,CAAC;IAChB,CAAC;IAED,2BAAQ,GAAR;QACI,kCAAkC;QAClC,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE,CAAC;QACzB,kBAAkB;QAClB,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC;QACtB,aAAa;QACb,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;IACxB,CAAC;IAEA,qBAAqB;IACrB,yBAAM,GAAN,UAAO,EAAS;QACb,uBAAuB;QACvB,IAAI,IAAI,CAAC,iBAAiB,EAAE,GAAG,IAAI,CAAC,UAAU,EAAE;YAC5C,SAAS;YACT,IAAI,CAAC,QAAQ,EAAE,CAAC;YAChB,OAAO;SACV;QACD,0BAA0B;QAC1B,IAAI,YAAY,GAAG,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,GAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC;QAC9D,IAAI,UAAU,GAAG,EAAE,CAAC;QACpB,IAAI,CAAC,IAAI,CAAC,OAAO,GAAG,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,YAAY,GAAG,CAAC,GAAG,GAAG,UAAU,CAAC,CAAC,CAAC;IACnF,CAAC;IAGD,wBAAwB;IAExB,eAAe;IAEf,wBAAK,GAAL;IAEA,CAAC;IA/CA;QADC,QAAQ,CAAC,EAAE,CAAC,OAAO,CAAC;gDACU;IAJf,QAAQ;QAD5B,OAAO;OACa,QAAQ,CAsD5B;IAAD,eAAC;CAtDD,AAsDC,CAtDqC,EAAE,CAAC,SAAS,GAsDjD;kBAtDoB,QAAQ","file":"","sourceRoot":"..\\..\\..\\..\\assets\\Scripts","sourcesContent":["// Learn TypeScript:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/typescript.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\nimport { Game } from './GameCtrl';\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n\r\n@ccclass\r\nexport default class NewClass extends cc.Component {\r\n\r\n     // 星星和主角之间的距离小雨这个数值时，就会完成收集\r\n     @property(cc.Integer)\r\n     private pickRadius: number = 0;\r\n\r\n     private game: Game = null;\r\n \r\n     public init(game:Game) {\r\n         this.game = game;\r\n     }\r\n\r\n     getPlayerDistance() {\r\n         console.log(this.game.playerNode);\r\n        // 根据 player 节点位置判断距离\r\n        let playerPos = this.game.playerNode.getPosition();\r\n        // 根据两点位置计算两点之间距离\r\n        let dist = this.node.position.sub(playerPos).mag();\r\n        return dist;\r\n    }\r\n\r\n    onPicked() {\r\n        // 当星星被收集时，调用 Game 脚本中的接口，生成一个新的星星\r\n        this.game.spawnNewStar();\r\n        // 调用 Game 脚本的得分方法\r\n        this.game.gainScore();\r\n        // 然后销毁当前星星节点\r\n        this.node.destroy();\r\n    }\r\n\r\n     // called every frame\r\n     update(dt:number) {\r\n        // 每帧判断和主角之间的距离是否小于收集距离\r\n        if (this.getPlayerDistance() < this.pickRadius) {\r\n            // 调用收集行为\r\n            this.onPicked();\r\n            return;\r\n        }\r\n        // 根据 Game 脚本中的计时器更新星星的透明度\r\n        let opacityRatio = 1 - this.game.timer/this.game.starDuration;\r\n        let minOpacity = 50;\r\n        this.node.opacity = minOpacity + Math.floor(opacityRatio * (255 - minOpacity));\r\n    }\r\n\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {}\r\n\r\n    start () {\r\n\r\n    }\r\n\r\n    // update (dt) {}\r\n}\r\n"]}