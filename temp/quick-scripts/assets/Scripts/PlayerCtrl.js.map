{"version":3,"sources":["PlayerCtrl.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\assets\\Scripts","sourcesContent":["// Learn TypeScript:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/typescript.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class NewClass extends cc.Component {\r\n\r\n    //主角跳跃的高度\r\n    @property(cc.Integer)\r\n    private jumpHeight : number = 0 ;\r\n    //主角跳跃的持续时间\r\n    @property(cc.Integer)\r\n    private jumpDuration : number = 0;\r\n\r\n    //最大移动速度\r\n    @property(cc.Integer)\r\n    private maxMoveSpeed:number = 0 ;\r\n\r\n    //加速度\r\n    @property(cc.Integer)\r\n    private accel: number = 0;\r\n\r\n    //跳跃音效\r\n    @property(cc.AudioClip)\r\n    private jumpAudio: cc.AudioClip = null ;\r\n\r\n    private xSpeed: number = 0 ; \r\n    private accLeft: boolean = false;\r\n    private accRight:boolean = false;\r\n    private jumpAction: cc.Action = null;\r\n\r\n    private setJumpAction(){\r\n        //跳跃上升\r\n        let jumpUp = cc.moveBy(this.jumpDuration,cc.v2(0,this.jumpHeight)).easing(cc.easeCubicActionOut());\r\n        //下落\r\n        let jumpDown = cc.moveBy(this.jumpDuration,cc.v2(0,-this.jumpHeight)).easing(cc.easeCubicActionIn());\r\n        //添加一个回调函数，用于动作结束时调用我们定义的其他方法\r\n        let callback = cc.callFunc(this.playJumpSound,this);\r\n        //不断重复，而且每次完成落地动作后调用回调来播放声音\r\n        return cc.repeatForever(cc.sequence(jumpUp,jumpDown,callback));\r\n\r\n    }\r\n\r\n    //回调函数  播放声音\r\n    private playJumpSound(){\r\n        // cc.audioEngine.play(this.jumpAudio,false,1);\r\n        cc.audioEngine.playEffect(this.jumpAudio as any, false);\r\n    }\r\n\r\n    // 添加事件监听\r\n    private addEventListeners(){\r\n        //键盘监听\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this);\r\n        //鼠标点击屏幕事件\r\n        cc.find(\"Canvas\").on(cc.Node.EventType.TOUCH_START,this.onScreenTouchStart,this);\r\n        cc.find(\"Canvas\").on(cc.Node.EventType.TOUCH_CANCEL,this.onScreenTouchEnd,this);\r\n        cc.find(\"Canvas\").on(cc.Node.EventType.TOUCH_END,this.onScreenTouchEnd,this);\r\n    }\r\n\r\n    private moveLeft(){\r\n        this.accLeft = true;\r\n        this.accRight = false;\r\n    }\r\n\r\n    private moveRight() {\r\n        this.accLeft = false;\r\n        this.accRight = true;\r\n    }\r\n\r\n    private stopMove() {\r\n        this.accLeft = false;\r\n        this.accRight = false;\r\n    }\r\n\r\n    //屏幕点击结束\r\n    private onScreenTouchEnd() {\r\n        this.stopMove();\r\n    }\r\n      //屏幕点击结束开始\r\n    private onScreenTouchStart(event: cc.Event.EventTouch) {\r\n    \r\n        if (event.getLocationX() > cc.winSize.width/2) {\r\n            this.moveRight();\r\n        } else {\r\n            this.moveLeft();\r\n        }\r\n    }\r\n\r\n    private onKeyDown(event: cc.Event.EventKeyboard) {\r\n        switch ((event as any).keyCode) {\r\n            case cc.KEY.a:\r\n            case cc.KEY.left:\r\n                this.moveLeft();\r\n                break;\r\n            case cc.KEY.d:\r\n            case cc.KEY.right:\r\n                this.moveRight();\r\n                break;\r\n        }\r\n    }\r\n\r\n    private onKeyUp(event: cc.Event.EventKeyboard) {\r\n        switch ((event as any).keyCode) {\r\n            case cc.KEY.a:\r\n            case cc.KEY.left:\r\n                this.stopMove();\r\n                break;\r\n            case cc.KEY.d:\r\n            case cc.KEY.right:\r\n                this.stopMove();\r\n                break;\r\n        }\r\n    }\r\n\r\n    onLoad () {\r\n         // 初始化跳跃动作\r\n         this.jumpAction = this.setJumpAction();\r\n         this.node.runAction(this.jumpAction);\r\n \r\n         // 加速度方向开关\r\n         this.accLeft = false;\r\n         this.accRight = false;\r\n         // 主角当前水平方向速度\r\n         this.xSpeed = 0;\r\n \r\n         // 初始化输入监听\r\n         this.addEventListeners();\r\n    }\r\n\r\n    start () {\r\n\r\n    }\r\n\r\n    update (dt) {\r\n         // 根据当前加速度方向每帧更新速度\r\n         if (this.accLeft) {\r\n            this.xSpeed -= this.accel * dt;\r\n        } else if (this.accRight) {\r\n            this.xSpeed += this.accel * dt;\r\n        }\r\n        // 限制主角的速度不能超过最大值\r\n        if (Math.abs(this.xSpeed) > this.maxMoveSpeed) {\r\n            // if speed reach limit, use max speed with current direction\r\n            this.xSpeed = this.maxMoveSpeed * this.xSpeed / Math.abs(this.xSpeed);\r\n        }\r\n\r\n        // 根据当前速度更新主角的位置\r\n        this.node.x += this.xSpeed * dt;\r\n        if (this.node.x <= -this.node.parent.width / 2) {\r\n            this.node.x = this.node.parent.width / 2;\r\n        }\r\n        if (this.node.x > this.node.parent.width / 2) {\r\n            this.node.x = -this.node.parent.width / 2;\r\n        }\r\n    }\r\n}\r\n"]}